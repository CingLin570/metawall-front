(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9afba508"],{"00b4":function(e,t,a){"use strict";a("ac1f");var r=a("23e7"),s=a("da84"),n=a("c65b"),o=a("e330"),c=a("1626"),i=a("861d"),d=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},!0===t.test("abc")&&e}(),l=s.Error,u=o(/./.test);r({target:"RegExp",proto:!0,forced:!d},{test:function(e){var t=this.exec;if(!c(t))return u(this,e);var a=n(t,this,e);if(null!==a&&!i(a))throw new l("RegExp exec method returned something other than an Object or null");return!!a}})},"107c":function(e,t,a){var r=a("d039"),s=a("da84"),n=s.RegExp;e.exports=r((function(){var e=n("(?<a>b)","g");return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},"385a":function(e,t,a){"use strict";a.r(t);a("b0c0");var r=a("7a23"),s={class:"container mt-7 mb-7 mb-md-0 px-lg-12"},n={class:"row"},o={class:"col-md-7"},c=Object(r["i"])("div",{class:"card mb-5 rounded-0 border-2 position-relative"},[Object(r["i"])("h2",{class:"text-center fw-bold py-3 mb-0 fs-5"},"修改個人資料"),Object(r["i"])("div",{class:"position-absolute border border-dark border-2 w-100 py-4",style:{"z-index":"-1",top:"10px",left:"-6px"}})],-1),i={class:"card bg-transparent border-0"},d={class:"card-header bg-transparent border-0"},l={class:"nav nav-tabs card-header-tabs",id:"myTab",role:"tablist"},u=["onClick"],b={class:"tab-content border border-dark border-2 rounded",id:"myTabContent"};function p(e,t,a,p,f,m){var h=Object(r["H"])("Sidebar"),v=Object(r["H"])("SidebarSm");return Object(r["y"])(),Object(r["h"])("section",s,[Object(r["i"])("div",n,[Object(r["i"])("div",o,[c,Object(r["i"])("div",i,[Object(r["i"])("div",d,[Object(r["i"])("ul",l,[(Object(r["y"])(!0),Object(r["h"])(r["a"],null,Object(r["F"])(f.tabs,(function(e){return Object(r["y"])(),Object(r["h"])("li",{key:e.modal,class:"nav-item border border-dark border-2 border-bottom-0 rounded bg-white",role:"presentation"},[Object(r["i"])("button",{class:Object(r["s"])(["nav-link nav-tabs",{active:f.currentTab===e.modal}]),type:"button",onClick:function(t){return f.currentTab=e.modal}},Object(r["K"])(e.name),11,u)])})),128))])]),Object(r["i"])("div",b,[Object(r["i"])("div",{class:Object(r["s"])(["tab-pane",{"show active":m.currentTabComponent}]),id:"name-edit",role:"tabpanel","aria-labelledby":"name-edit"},[(Object(r["y"])(),Object(r["f"])(r["b"],null,[(Object(r["y"])(),Object(r["f"])(Object(r["I"])(m.currentTabComponent)))],1024))],2)])])]),Object(r["l"])(h)]),Object(r["l"])(v)])}var f=a("5ea5"),m=a("7441"),h=a("0f71"),v=a.n(h),g={class:"card-body bg-white px-10 py-5"},O={class:"needs-validation",novalidate:""},j={key:0,src:v.a,alt:"user",class:"img-fluid w-50 mx-auto mb-4 d-block rounded-circle"},x=["src"],w={class:"input-group mb-3"},y={class:"btn btn-dark mx-auto"},P=Object(r["k"])(" 上傳大頭照 "),k={class:"mb-3"},I=Object(r["i"])("label",{for:"editName",class:"form-label"},"暱稱",-1),$=Object(r["i"])("p",{class:"mb-0"},"性別",-1),E={class:"d-flex mb-5"},T={class:"form-check me-4"},R=Object(r["i"])("label",{class:"form-check-label",for:"male"}," 男性 ",-1),C={class:"form-check"},U=Object(r["i"])("label",{class:"form-check-label",for:"female"}," 女性 ",-1),M={class:"d-grid"},S={key:0,class:"text-danger text-center fs-7 d-block"};function F(e,t,a,s,n,o){return Object(r["y"])(),Object(r["h"])("div",g,[Object(r["i"])("form",O,[n.photoPreview?(Object(r["y"])(),Object(r["h"])("img",{key:1,src:n.photoPreview,alt:"user",class:"img-fluid w-50 mx-auto mb-4 d-block rounded-circle"},null,8,x)):(Object(r["y"])(),Object(r["h"])("img",j)),Object(r["i"])("div",w,[Object(r["i"])("label",y,[Object(r["i"])("input",{id:"upload-file",ref:"upload-file",style:{display:"none"},type:"file",class:"is-valid",accept:"image/png, image/jpeg, image/jpg",onChange:t[0]||(t[0]=function(){return o.getPreviewFile&&o.getPreviewFile.apply(o,arguments)})},null,544),P])]),Object(r["i"])("div",k,[I,Object(r["U"])(Object(r["i"])("input",{type:"text",class:"form-control",id:"editName","onUpdate:modelValue":t[1]||(t[1]=function(e){return n.user.name=e})},null,512),[[r["P"],n.user.name]])]),$,Object(r["i"])("div",E,[Object(r["i"])("div",T,[Object(r["U"])(Object(r["i"])("input",{class:"form-check-input",type:"radio",name:"sex",id:"male",value:"male","onUpdate:modelValue":t[2]||(t[2]=function(e){return n.user.sex=e})},null,512),[[r["N"],n.user.sex]]),R]),Object(r["i"])("div",C,[Object(r["U"])(Object(r["i"])("input",{class:"form-check-input",type:"radio",name:"sex",id:"female",value:"female","onUpdate:modelValue":t[3]||(t[3]=function(e){return n.user.sex=e})},null,512),[[r["N"],n.user.sex]]),U])]),Object(r["i"])("div",M,[Object(r["i"])("button",{type:"button",class:"btn btn-primary border border-dark border-2 mb-2 shadow-black",onClick:t[4]||(t[4]=function(e){return o.submit()})}," 送出更新 "),n.errorMessage?(Object(r["y"])(),Object(r["h"])("p",S,Object(r["K"])(n.errorMessage),1)):Object(r["g"])("",!0)])])])}var L=a("1da1"),A=a("5530"),V=(a("96cf"),a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("9911"),a("5502")),z={name:"EditProfile",data:function(){return{user:{name:"",photo:"",sex:""},photoPreview:"",isUpdatePhoto:!1,errorMessage:"",type:"avatar"}},computed:Object(A["a"])({},Object(V["b"])(["token"])),mounted:function(){this.getProfile()},methods:{getProfile:function(){var e=this;return new Promise((function(t,a){e.$store.dispatch("updateLoading",!0);var r={method:"GET",url:"".concat("https://metawall-express-final.onrender.com","/api/v1/user/profile"),headers:{authorization:"Bearer ".concat(e.token)}};e.$http(r).then((function(a){e.$store.dispatch("updateLoading",!1),e.setProfile(a.data.message),t(a.data.message)})).catch((function(t){e.$store.dispatch("updateLoading",!1),a(t.response.data.message)}))}))},setProfile:function(e){var t=e.name,a=e.photo,r=e.sex;this.user={name:t,photo:a,sex:r},this.photoPreview=a},getPreviewFile:function(){var e=this.$refs["upload-file"];this.photoPreview=URL.createObjectURL(e.files[0]),this.isUpdatePhoto=!0},uploadFile:function(){var e=this;return new Promise((function(t,a){var r=e.$refs["upload-file"],s=new FormData;s.append("image",r.files[0]),s.append("type",e.type),r.files=(new DataTransfer).files;var n={method:"POST",url:"".concat("https://metawall-express-final.onrender.com","/api/v1/file"),headers:{authorization:"Bearer ".concat(e.token)},data:s};e.$http(n).then((function(a){e.user.photo=a.data.message.link,e.photoPreview="",t(a.data.status)})).catch((function(t){e.errorMessage=t.response.data.message,a(t.response.data.message),e.photoPreview=""}))}))},updateProfile:function(){var e=this;return new Promise((function(t,a){var r={method:"PATCH",url:"".concat("https://metawall-express-final.onrender.com","/api/v1/user/profile"),headers:{authorization:"Bearer ".concat(e.token)},data:e.user};e.$http(r).then((function(e){t(e.data.message)})).catch((function(e){a(e.response.data.message)}))}))},submit:function(){var e=this;return Object(L["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.$store.dispatch("updateLoading",!0),!e.isUpdatePhoto){t.next=5;break}return t.next=5,e.uploadFile();case 5:return t.next=7,e.updateProfile();case 7:a=t.sent,e.setProfile(a),e.$store.dispatch("updateInfo",{name:a.name,photo:a.photo,_id:a._id}),e.errorMessage="",e.$store.dispatch("updateLoading",!1),t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](0),e.errorMessage||(e.errorMessage=t.t0),e.$store.dispatch("updateLoading",!1),e.getProfile();case 19:case"end":return t.stop()}}),t,null,[[0,14]])})))()}}},H=a("d959"),N=a.n(H);const _=N()(z,[["render",F]]);var B=_,K={class:"card-body bg-white px-10 py-5"},D={class:"mb-3"},J=Object(r["i"])("label",{for:"newPassword",class:"form-label"},"輸入新密碼",-1),Y={class:"mb-3"},Z=Object(r["i"])("label",{for:"confirmPassword",class:"form-label"},"再次輸入",-1),q={class:"d-grid"},G=["disabled"],Q={key:0,class:"text-danger text-center mb-2 fs-7 d-block"};function W(e,t,a,s,n,o){var c=Object(r["H"])("Field"),i=Object(r["H"])("error-message"),d=Object(r["H"])("Form");return Object(r["y"])(),Object(r["h"])("div",K,[Object(r["l"])(d,{class:"needs-validation"},{default:Object(r["T"])((function(e){var a=e.errors;return[Object(r["i"])("div",D,[J,Object(r["l"])(c,{type:"password",class:Object(r["s"])(["form-control",{"is-invalid":a["password"]}]),name:"password",id:"newPassword",placeholder:"請輸入新密碼",rules:o.validatePassword,modelValue:n.user.password,"onUpdate:modelValue":t[0]||(t[0]=function(e){return n.user.password=e})},null,8,["class","rules","modelValue"]),Object(r["l"])(i,{name:"password",class:"invalid-feedback"})]),Object(r["i"])("div",Y,[Z,Object(r["l"])(c,{type:"password",class:Object(r["s"])(["form-control",{"is-invalid":a["confirmPassword"]}]),id:"confirmPassword",placeholder:"再次輸入新密碼",name:"confirmPassword",rules:"required|confirmed:@password",modelValue:n.user.confirmPassword,"onUpdate:modelValue":t[1]||(t[1]=function(e){return n.user.confirmPassword=e})},null,8,["class","modelValue"]),Object(r["l"])(i,{name:"confirmPassword",class:"invalid-feedback"})]),Object(r["i"])("div",q,[Object(r["i"])("button",{type:"button",class:"btn btn-gray-dark border border-dark border-2 shadow-blac mb-2",disabled:!o.formIsFinished,onClick:t[2]||(t[2]=function(e){return o.submit()})}," 重設密碼 ",8,G),n.errorMessage?(Object(r["y"])(),Object(r["h"])("p",Q,Object(r["K"])(n.errorMessage),1)):Object(r["g"])("",!0)])]})),_:1})])}a("ac1f"),a("00b4");var X={name:"EditPassword",data:function(){return{user:{password:"",confirmPassword:""},errorMessage:""}},computed:Object(A["a"])(Object(A["a"])({},Object(V["b"])(["token"])),{},{formIsFinished:function(){return this.user.password&&this.user.confirmPassword}}),methods:{validatePassword:function(e){if(!e)return"密碼為必填";var t=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/;return!!t.test(e)||"密碼需符合八碼以上並英數混合，至少各一個大小寫英文字母"},submit:function(){var e=this;this.$store.dispatch("updateLoading",!0);var t={method:"PATCH",url:"".concat("https://metawall-express-final.onrender.com","/api/v1/user/updatePassword"),headers:{authorization:"Bearer ".concat(this.token)},data:this.user};this.$http(t).then((function(t){e.$store.dispatch("updateLoading",!1),e.$store.dispatch("updateToken",t.data.user.token),Object.assign(e.$data,e.$options.data()),e.$router.push({name:"首頁"})})).catch((function(t){e.$store.dispatch("updateLoading",!1),e.errorMessage=t.response.data.message}))}}};const ee=N()(X,[["render",W]]);var te=ee,ae={name:"profile",components:{Sidebar:f["a"],SidebarSm:m["a"],EditProfile:B,EditPassword:te},data:function(){return{currentTab:"Profile",tabs:[{name:"暱稱修改",modal:"Profile"},{name:"重設密碼",modal:"Password"}]}},computed:{currentTabComponent:function(){return"Edit"+this.currentTab}}};const re=N()(ae,[["render",p]]);t["default"]=re},9263:function(e,t,a){"use strict";var r=a("c65b"),s=a("e330"),n=a("577e"),o=a("ad6d"),c=a("9f7f"),i=a("5692"),d=a("7c73"),l=a("69f3").get,u=a("fce3"),b=a("107c"),p=i("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,m=f,h=s("".charAt),v=s("".indexOf),g=s("".replace),O=s("".slice),j=function(){var e=/a/,t=/b*/g;return r(f,e,"a"),r(f,t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),x=c.BROKEN_CARET,w=void 0!==/()??/.exec("")[1],y=j||w||x||u||b;y&&(m=function(e){var t,a,s,c,i,u,b,y=this,P=l(y),k=n(e),I=P.raw;if(I)return I.lastIndex=y.lastIndex,t=r(m,I,k),y.lastIndex=I.lastIndex,t;var $=P.groups,E=x&&y.sticky,T=r(o,y),R=y.source,C=0,U=k;if(E&&(T=g(T,"y",""),-1===v(T,"g")&&(T+="g"),U=O(k,y.lastIndex),y.lastIndex>0&&(!y.multiline||y.multiline&&"\n"!==h(k,y.lastIndex-1))&&(R="(?: "+R+")",U=" "+U,C++),a=new RegExp("^(?:"+R+")",T)),w&&(a=new RegExp("^"+R+"$(?!\\s)",T)),j&&(s=y.lastIndex),c=r(f,E?a:y,U),E?c?(c.input=O(c.input,C),c[0]=O(c[0],C),c.index=y.lastIndex,y.lastIndex+=c[0].length):y.lastIndex=0:j&&c&&(y.lastIndex=y.global?c.index+c[0].length:s),w&&c&&c.length>1&&r(p,c[0],a,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(c[i]=void 0)})),c&&$)for(c.groups=u=d(null),i=0;i<$.length;i++)b=$[i],u[b[0]]=c[b[1]];return c}),e.exports=m},"9f7f":function(e,t,a){var r=a("d039"),s=a("da84"),n=s.RegExp,o=r((function(){var e=n("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),c=o||r((function(){return!n("a","y").sticky})),i=o||r((function(){var e=n("^r","gy");return e.lastIndex=2,null!=e.exec("str")}));e.exports={BROKEN_CARET:i,MISSED_STICKY:c,UNSUPPORTED_Y:o}},ac1f:function(e,t,a){"use strict";var r=a("23e7"),s=a("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==s},{exec:s})},ad6d:function(e,t,a){"use strict";var r=a("825a");e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},fce3:function(e,t,a){var r=a("d039"),s=a("da84"),n=s.RegExp;e.exports=r((function(){var e=n(".","s");return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))}}]);
//# sourceMappingURL=chunk-9afba508.3577a46c.js.map